# 32 bit addresses - IPv4中的32位地址
***（Lecture5-IP.pdf 第2页，Panopto: 19 Oct 32:08)*** 

## 小故事

* 在当年(1981)认为这个数量足够的大了，可惜现在完全不够用
	* 你会觉得他们目光太短浅了 怎么不设计48或64位的，你咋不想想他们咋没设计16位或24位的呢 

* IP的最初概念中有8位用来表示站点，24位来指定那个站点上的机器  
Original concept of IP was to have 8 bits indicating the site, and 24 bits to specify a machine at that site.

* 只有美国大型公司，政府，大学和少量国防相关的行动才被提议使用，这些都是在北约(NATO)

* 即便是在80年代，这也是被认为是一个很糟的决定：256个站点根本不够用

## IP Notation 中的标识

* 我们所说的32位是指2<sup>32</sup>个地址, 在IPv6中是128位 (2<sup>128</sup>)

* 按照惯例IPv4是由四段十进制数组成，每一段由1个字节编码(很浪费)，由逗号将每一段分开. 
Conventionally written as four decimal numbers, each encoding one byte (wastefully), separated by dots.

* 通常不是零填充(zero-padded), 比如是192.168.1.1而不是192.168.001.001

* 现在看来十六进制会好很多(你可以直接编码解码和掩码)，但在70年代十六进制并没有被广泛使用，IPv6就是16进制的.  
Hexademical would have been much better (you can encode, decode and mask by eye) but hexadecimal wasn't used much in the 1970s. IPv6 is hex, as we will see. 

## Routing Decisions 路由选择

* 所有IP地址都会标记一个网络(地址的第一段部分)和该网络上的主机(剩下的部分)，我们等会会定义他们  
All IP addresses identify a network (the left most part of the address) and the host on that network (the rest of the address).

* 路由器会忽略网络上所有非本地地址的主机  
A router ignores the host on network part for all non-local addresses.  
路由器会在路由表中查找网络，并选择通过哪个接口发送数据包  
A router looks up the network in a routing table, and chooses which interface to send the packet out through.  
	* 至于其它情况由Default network处理  
	“Default network” handdles all other cases.

* 越靠近互联网中心的路由器会有越大的routing table，它们必须要知道互联网中每一个网络的位置  
A router close to the centre of the inter-network needs to know about most networks.

* 在IP设计之初，RAM还大多数是64KB的.. 那时候的路由器也就只有这么多RAM

<br/>

## Priority: performance on limited hardware 首要优先考虑硬件的性能

* 以那个年代的速度和流量，建立一个大型分布式的路由表是很难的，必须保证需要交换信息的网络数量尽可能的少  
With the speed and feeds of the era, building large distributed routing tables was hard. It was essential to keep the number of networks about which information need to be exchanged to a minimum.  

* 将其限制在256个网络是不合理的，但也必须得有一个较低的限制就是了

<br/>

### 重点：为什么IPv4留了大量未分配地址(unallocated addresses)
* 32 bits 约等于四十亿个地址，在那个年代，几千台电脑就被认为是个上限了  
4 billion addresses in a era where a few thousand computers would be seen as an upper bound.   
**有效的分配并不重要，也不是设计目标：他们预期的利用率只有1%**  
**Efficient allocation did not matter and was not a design goal: they anticipated utilisation of a fraction of a percent.**

* 优先需要考虑的是在当下硬件水平上作出快速的决策  
The priority was being able to make routing decisions quickly on realistic hardware.  

他们认为可以随意浪费IP地址 由此 出现了所谓的

## "Classful" Addresses：说到浪费 不得不提这个邪恶的开始

### 以0开头
* 如果地址以0开头，则前8个bit用来标识网络，剩下24位用来标识那个网络上host的主机  
If the address starts with a 0, the first 8 bits identify the network, the remaining 24 bits identify the host on that network.

* 比如说 前8个bit: 1.x.y.z 到 127.x.y.z 这些用来标识网络

* 他们将地址中128个“A类”地址(每个可以放2<sup>24</sup>个主机 约等于1600万)，分配给了大型公司 像MIT，福特 波音 英国政府等等  
Gives 128 "Class A" addresses to large sites that get 2<sup>24</sup> (~16milion) hosts each. These went to MIT, BBN, Ford, DEC, Boeing, the UK government, etc.
	* 第一段中的0没有使用，127保留被用来做回路(几乎完全是127.0.0.1)。瞬间浪费掉了1600万个地址(2<sup>25</sup>-1).  
	Net 0 not used, net 127 reserved for loopback (almost exclusively 127.0.0.1). Instantly wastes over 16 milion address.

<br/>

### 以10开头
